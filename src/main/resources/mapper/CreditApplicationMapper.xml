<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bank.creditquota.mapper.CreditApplicationMapper">
    <resultMap id="CreditApplicationResultMap" type="com.bank.creditquota.entity.CreditApplication">
        <id property="applicationId" column="application_id"/>
        <result property="customerId" column="customer_id"/>
        <result property="applicationType" column="application_type"/>
        <result property="applicationAmount" column="application_amount"/>
        <result property="currency" column="currency"/>
        <result property="applicationPurpose" column="application_purpose"/>
        <result property="guaranteeMethod" column="guarantee_method"/>
        <result property="termMonths" column="term_months"/>
        <result property="applicationDate" column="application_date"/>
        <result property="applicant" column="applicant"/>
        <result property="department" column="department"/>
        <result property="status" column="status"/>
        <result property="currentApprover" column="current_approver"/>
        <result property="currentApproveNode" column="current_approve_node"/>
        <result property="approveResult" column="approve_result"/>
        <result property="approveAdvice" column="approve_advice"/>
        <result property="approveDate" column="approve_date"/>
        <result property="createdBy" column="created_by"/>
        <result property="createdTime" column="created_time"/>
        <result property="updatedBy" column="updated_by"/>
        <result property="updatedTime" column="updated_time"/>
    </resultMap>

    <sql id="Base_Column_List">
        application_id, customer_id, application_type, application_amount, currency, 
        application_purpose, guarantee_method, term_months, application_date, 
        applicant, department, status, current_approver, current_approve_node, 
        approve_result, approve_advice, approve_date, created_by, created_time, 
        updated_by, updated_time
    </sql>

    <insert id="insert" parameterType="com.bank.creditquota.entity.CreditApplication">
        INSERT INTO t_credit_application (
            application_id, customer_id, application_type, application_amount, currency,
            application_purpose, guarantee_method, term_months, application_date,
            applicant, department, status, current_approver, current_approve_node,
            approve_result, approve_advice, approve_date, created_by, updated_by
        ) VALUES (
            #{applicationId}, #{customerId}, #{applicationType}, #{applicationAmount}, #{currency},
            #{applicationPurpose}, #{guaranteeMethod}, #{termMonths}, #{applicationDate},
            #{applicant}, #{department}, #{status}, #{currentApprover}, #{currentApproveNode},
            #{approveResult}, #{approveAdvice}, #{approveDate}, #{createdBy}, #{updatedBy}
        )
    </insert>

    <update id="updateById" parameterType="com.bank.creditquota.entity.CreditApplication">
        UPDATE t_credit_application
        <set>
            <if test="customerId != null">
                customer_id = #{customerId},
            </if>
            <if test="applicationType != null">
                application_type = #{applicationType},
            </if>
            <if test="applicationAmount != null">
                application_amount = #{applicationAmount},
            </if>
            <if test="currency != null">
                currency = #{currency},
            </if>
            <if test="applicationPurpose != null">
                application_purpose = #{applicationPurpose},
            </if>
            <if test="guaranteeMethod != null">
                guarantee_method = #{guaranteeMethod},
            </if>
            <if test="termMonths != null">
                term_months = #{termMonths},
            </if>
            <if test="applicationDate != null">
                application_date = #{applicationDate},
            </if>
            <if test="applicant != null">
                applicant = #{applicant},
            </if>
            <if test="department != null">
                department = #{department},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
            <if test="currentApprover != null">
                current_approver = #{currentApprover},
            </if>
            <if test="currentApproveNode != null">
                current_approve_node = #{currentApproveNode},
            </if>
            <if test="approveResult != null">
                approve_result = #{approveResult},
            </if>
            <if test="approveAdvice != null">
                approve_advice = #{approveAdvice},
            </if>
            <if test="approveDate != null">
                approve_date = #{approveDate},
            </if>
            <if test="updatedBy != null">
                updated_by = #{updatedBy},
            </if>
            updated_time = NOW()
        </set>
        WHERE application_id = #{applicationId}
    </update>

    <delete id="deleteById" parameterType="java.lang.String">
        DELETE FROM t_credit_application WHERE application_id = #{applicationId}
    </delete>

    <select id="selectById" parameterType="java.lang.String" resultMap="CreditApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_credit_application
        WHERE application_id = #{applicationId}
    </select>

    <select id="selectAll" resultMap="CreditApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_credit_application
        ORDER BY application_date DESC
    </select>

    <select id="selectByCustomerId" parameterType="java.lang.String" resultMap="CreditApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_credit_application
        WHERE customer_id = #{customerId}
        ORDER BY application_date DESC
    </select>

    <select id="selectByApplicationType" parameterType="java.lang.String" resultMap="CreditApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_credit_application
        WHERE application_type = #{applicationType}
        ORDER BY application_date DESC
    </select>

    <select id="selectByStatus" parameterType="java.lang.String" resultMap="CreditApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_credit_application
        WHERE status = #{status}
        ORDER BY application_date DESC
    </select>
</mapper>