<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bank.creditquota.mapper.UsageApplicationMapper">
    <resultMap id="UsageApplicationResultMap" type="com.bank.creditquota.entity.UsageApplication">
        <id property="usageId" column="usage_id"/>
        <result property="applicationId" column="application_id"/>
        <result property="customerId" column="customer_id"/>
        <result property="quotaId" column="quota_id"/>
        <result property="productType" column="product_type"/>
        <result property="usageAmount" column="usage_amount"/>
        <result property="currency" column="currency"/>
        <result property="usageTerm" column="usage_term"/>
        <result property="interestRate" column="interest_rate"/>
        <result property="repaymentMethod" column="repayment_method"/>
        <result property="guaranteeMethod" column="guarantee_method"/>
        <result property="fundUsage" column="fund_usage"/>
        <result property="applicationDate" column="application_date"/>
        <result property="status" column="status"/>
        <result property="contractNo" column="contract_no"/>
        <result property="loanNoteNo" column="loan_note_no"/>
        <result property="disbursementDate" column="disbursement_date"/>
        <result property="maturityDate" column="maturity_date"/>
        <result property="createdBy" column="created_by"/>
        <result property="createdTime" column="created_time"/>
        <result property="updatedBy" column="updated_by"/>
        <result property="updatedTime" column="updated_time"/>
    </resultMap>

    <sql id="Base_Column_List">
        usage_id, application_id, customer_id, quota_id, product_type, usage_amount,
        currency, usage_term, interest_rate, repayment_method, guarantee_method,
        fund_usage, application_date, status, contract_no, loan_note_no,
        disbursement_date, maturity_date, created_by, created_time, updated_by, updated_time
    </sql>

    <insert id="insert" parameterType="com.bank.creditquota.entity.UsageApplication">
        INSERT INTO t_usage_application (
            application_id, customer_id, quota_id, product_type, usage_amount,
            currency, usage_term, interest_rate, repayment_method, guarantee_method,
            fund_usage, application_date, status, contract_no, loan_note_no,
            disbursement_date, maturity_date, created_by, updated_by
        ) VALUES (
            #{applicationId}, #{customerId}, #{quotaId}, #{productType}, #{usageAmount},
            #{currency}, #{usageTerm}, #{interestRate}, #{repaymentMethod}, #{guaranteeMethod},
            #{fundUsage}, #{applicationDate}, #{status}, #{contractNo}, #{loanNoteNo},
            #{disbursementDate}, #{maturityDate}, #{createdBy}, #{updatedBy}
        )
    </insert>

    <update id="updateById" parameterType="com.bank.creditquota.entity.UsageApplication">
        UPDATE t_usage_application
        <set>
            <if test="applicationId != null">
                application_id = #{applicationId},
            </if>
            <if test="customerId != null">
                customer_id = #{customerId},
            </if>
            <if test="quotaId != null">
                quota_id = #{quotaId},
            </if>
            <if test="productType != null">
                product_type = #{productType},
            </if>
            <if test="usageAmount != null">
                usage_amount = #{usageAmount},
            </if>
            <if test="currency != null">
                currency = #{currency},
            </if>
            <if test="usageTerm != null">
                usage_term = #{usageTerm},
            </if>
            <if test="interestRate != null">
                interest_rate = #{interestRate},
            </if>
            <if test="repaymentMethod != null">
                repayment_method = #{repaymentMethod},
            </if>
            <if test="guaranteeMethod != null">
                guarantee_method = #{guaranteeMethod},
            </if>
            <if test="fundUsage != null">
                fund_usage = #{fundUsage},
            </if>
            <if test="applicationDate != null">
                application_date = #{applicationDate},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
            <if test="contractNo != null">
                contract_no = #{contractNo},
            </if>
            <if test="loanNoteNo != null">
                loan_note_no = #{loanNoteNo},
            </if>
            <if test="disbursementDate != null">
                disbursement_date = #{disbursementDate},
            </if>
            <if test="maturityDate != null">
                maturity_date = #{maturityDate},
            </if>
            <if test="updatedBy != null">
                updated_by = #{updatedBy},
            </if>
            updated_time = NOW()
        </set>
        WHERE usage_id = #{usageId}
    </update>

    <delete id="deleteById" parameterType="java.lang.String">
        DELETE FROM t_usage_application WHERE usage_id = #{usageId}
    </delete>

    <select id="selectById" parameterType="java.lang.String" resultMap="UsageApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_usage_application
        WHERE usage_id = #{usageId}
    </select>

    <select id="selectAll" resultMap="UsageApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_usage_application
        ORDER BY application_date DESC
    </select>

    <select id="selectByCustomerId" parameterType="java.lang.String" resultMap="UsageApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_usage_application
        WHERE customer_id = #{customerId}
        ORDER BY application_date DESC
    </select>

    <select id="selectByQuotaId" parameterType="java.lang.Long" resultMap="UsageApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_usage_application
        WHERE quota_id = #{quotaId}
        ORDER BY application_date DESC
    </select>

    <select id="selectByProductType" parameterType="java.lang.String" resultMap="UsageApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_usage_application
        WHERE product_type = #{productType}
        ORDER BY application_date DESC
    </select>

    <select id="selectByStatus" parameterType="java.lang.String" resultMap="UsageApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_usage_application
        WHERE status = #{status}
        ORDER BY application_date DESC
    </select>

    <select id="selectByApplicationId" parameterType="java.lang.String" resultMap="UsageApplicationResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM t_usage_application
        WHERE application_id = #{applicationId}
        ORDER BY application_date DESC
    </select>
</mapper>